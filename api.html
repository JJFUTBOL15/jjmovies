<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JJMovies API - Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        brand: '#8b5cf6',
                        dark: '#0f172a',
                        accent: '#a78bfa'
                    }
                }
            }
        }
    </script>
    <style>
        body { background: linear-gradient(to bottom, #0f172a, #020617); color: white; font-family: system-ui; }
        .glass { background: rgba(30, 41, 59, 0.6); backdrop-filter: blur(20px); border: 1px solid rgba(255,255,255,0.1); }
        .card { transition: transform 0.3s; }
        .card:hover { transform: scale(1.05); }
    </style>
</head>
<body class="min-h-screen p-6">
    <header class="text-center mb-12">
        <h1 class="text-5xl font-bold text-brand">ðŸŽ¥ JJMovies.lat API v1.0</h1>
        <p class="text-gray-400 mt-2">Genera embeds premium para pelÃ­culas y series. Uso personal.</p>
    </header>

    <!-- Dashboard Sections -->
    <section class="grid md:grid-cols-3 gap-8 mb-12">
        <!-- Top 10 Diario -->
        <div class="glass rounded-xl p-6">
            <h2 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-star mr-2 text-yellow-400"></i> Top 10 Hoy</h2>
            <div id="top10" class="space-y-4 overflow-y-auto max-h-96"></div>
        </div>

        <!-- Tendencias -->
        <div class="glass rounded-xl p-6">
            <h2 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-fire mr-2 text-red-500"></i> Tendencias</h2>
            <div id="trending" class="space-y-4 overflow-y-auto max-h-96"></div>
        </div>

        <!-- Estrenos -->
        <div class="glass rounded-xl p-6">
            <h2 class="text-2xl font-bold mb-4 flex items-center"><i class="fas fa-calendar mr-2 text-green-500"></i> Estrenos</h2>
            <div id="upcoming" class="space-y-4 overflow-y-auto max-h-96"></div>
        </div>
    </section>

    <!-- Generador PelÃ­culas/Series -->
    <section class="glass rounded-xl p-8 mb-8">
        <h2 class="text-3xl font-bold mb-6">Generador de Embed</h2>
        <div class="grid md:grid-cols-2 gap-6 mb-6">
            <div>
                <label class="block text-sm mb-2">Tipo:</label>
                <select id="type" class="w-full bg-white/10 border border-white/20 rounded px-4 py-3 text-white">
                    <option value="movie">PelÃ­cula</option>
                    <option value="tv">Serie</option>
                </select>
            </div>
            <div>
                <label class="block text-sm mb-2">TMDB ID:</label>
                <input type="text" id="tmdb-id" placeholder="Ej: 1084242 (Zootopia 2)" class="w-full bg-white/10 border border-white/20 rounded px-4 py-3 text-white">
            </div>
        </div>
        <div id="series-options" class="grid md:grid-cols-2 gap-6 mb-6 hidden">
            <div>
                <label class="block text-sm mb-2">Temporada:</label>
                <input type="number" id="season" value="1" min="1" class="w-full bg-white/10 border border-white/20 rounded px-4 py-3 text-white">
            </div>
            <div>
                <label class="block text-sm mb-2">Episodio:</label>
                <input type="number" id="episode" value="1" min="1" class="w-full bg-white/10 border border-white/20 rounded px-4 py-3 text-white">
            </div>
        </div>
        <button onclick="generateEmbed()" class="w-full bg-brand hover:bg-accent rounded px-6 py-4 font-bold text-lg">Generar Iframe</button>
        
        <div id="embed-code" class="mt-8 hidden">
            <h3 class="text-xl mb-4">CÃ³digo HTML:</h3>
            <textarea id="iframe-code" class="w-full bg-black/50 border border-white/20 rounded p-4 h-24 font-mono text-sm" readonly></textarea>
            <button onclick="copyCode()" class="mt-4 bg-green-600 hover:bg-green-700 rounded px-6 py-3 font-bold">Copiar</button>
            
            <h3 class="text-xl mt-8 mb-4">Preview:</h3>
            <div class="aspect-video bg-black rounded-xl overflow-hidden shadow-2xl">
                <iframe id="preview-iframe" class="w-full h-full" frameborder="0" allowfullscreen></iframe>
            </div>
        </div>
    </section>

    <!-- BÃºsqueda -->
    <section class="glass rounded-xl p-8">
        <h2 class="text-3xl font-bold mb-6">BÃºsqueda RÃ¡pida</h2>
        <input type="text" id="search" placeholder="Busca pelÃ­culas o series..." class="w-full bg-white/10 border border-white/20 rounded px-4 py-4 mb-6 text-lg">
        <div id="results" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
    </section>

    <script>
        const API_KEY = 'da8b836389708e0558de674492931977';
        const DOMAIN = 'https://jjmovies.lat';

        // Fetch Top 10, Trending, Upcoming
        async function loadDashboard() {
            // Top 10
            const topRes = await fetch(`https://api.themoviedb.org/3/movie/top_rated?api_key=${API_KEY}&language=es-MX&page=1`);
            const top = await topRes.json();
            const topContainer = document.getElementById('top10');
            top.results.slice(0,10).forEach(item => {
                topContainer.innerHTML += renderCard(item);
            });

            // Tendencias
            const trendRes = await fetch(`https://api.themoviedb.org/3/trending/all/day?api_key=${API_KEY}&language=es-MX`);
            const trend = await trendRes.json();
            const trendContainer = document.getElementById('trending');
            trend.results.slice(0,10).forEach(item => {
                trendContainer.innerHTML += renderCard(item);
            });

            // Estrenos
            const upcomingRes = await fetch(`https://api.themoviedb.org/3/movie/upcoming?api_key=${API_KEY}&language=es-MX&page=1`);
            const upcoming = await upcomingRes.json();
            const upcomingContainer = document.getElementById('upcoming');
            upcoming.results.slice(0,10).forEach(item => {
                upcomingContainer.innerHTML += renderCard(item);
            });
        }

        function renderCard(item) {
            const poster = item.poster_path ? `https://image.tmdb.org/t/p/w300${item.poster_path}` : 'https://via.placeholder.com/300x450?text=No+Poster';
            return `
                <div class="card rounded-lg overflow-hidden shadow-lg cursor-pointer" onclick="setId('${item.id}', '${item.media_type || 'movie'}')">
                    <img src="${poster}" alt="${item.title || item.name}" class="w-full">
                    <div class="p-2 text-center text-sm font-bold">${item.title || item.name}</div>
                    <div class="p-2 text-center text-xs text-gray-400">ID: ${item.id}</div>
                </div>
            `;
        }

        function setId(id, type) {
            document.getElementById('tmdb-id').value = id;
            document.getElementById('type').value = type;
            toggleSeriesOptions();
        }

        // Toggle series options
        document.getElementById('type').addEventListener('change', toggleSeriesOptions);
        function toggleSeriesOptions() {
            const isSeries = document.getElementById('type').value === 'tv';
            document.getElementById('series-options').classList.toggle('hidden', !isSeries);
        }

        // Generate Embed
        function generateEmbed() {
            const id = document.getElementById('tmdb-id').value;
            const type = document.getElementById('type').value;
            let url = `${DOMAIN}/player.html?id=${id}&type=${type}`;
            if (type === 'tv') {
                const season = document.getElementById('season').value;
                const episode = document.getElementById('episode').value;
                url += `&season=${season}&episode=${episode}`;
            }
            const iframe = `<iframe class="aspect-video w-full" src="${url}" frameborder="0" allowfullscreen></iframe>`;
            document.getElementById('iframe-code').value = iframe;
            document.getElementById('preview-iframe').src = url;
            document.getElementById('embed-code').classList.remove('hidden');
        }

        function copyCode() {
            const code = document.getElementById('iframe-code');
            code.select();
            document.execCommand('copy');
            alert('Â¡Copiado al portapapeles!');
        }

        // BÃºsqueda
        document.getElementById('search').addEventListener('input', async () => {
            const query = document.getElementById('search').value;
            if (query.length < 3) return;
            const type = document.getElementById('type').value;
            const res = await fetch(`https://api.themoviedb.org/3/search/${type}?api_key=${API_KEY}&query=${encodeURIComponent(query)}&language=es-MX`);
            const data = await res.json();
            const results = document.getElementById('results');
            results.innerHTML = '';
            data.results.slice(0,20).forEach(item => {
                results.innerHTML += renderCard(item);
            });
        });

        // Load on start
        loadDashboard();
        toggleSeriesOptions();
    </script>
</body>
</html>
