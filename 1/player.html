<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproduciendo en JJMovies.lat</title>
    <style>
        body, html { margin:0; padding:0; height:100%; background:#000; color:white; font-family:Arial; overflow:hidden; }
        .container { position:relative; width:100%; height:100%; }
        iframe { width:100%; height:100%; border:none; }
        .title { position:absolute; top:20px; left:50%; transform:translateX(-50%); font-size:32px; z-index:10; text-shadow: 2px 2px 4px black; }
        .loading { position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:28px; z-index:10; }
    </style>
</head>
<body>
    <div class="container">
        <div class="title" id="title">Cargando pel√≠cula...</div>
        <div class="loading">Conectando al servidor pro...</div>
        <iframe id="player" allowfullscreen allow="autoplay"></iframe>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        const season = params.get('season');
        const episode = params.get('episode');

        if (!id) {
            document.getElementById('title').textContent = 'Agrega ?id=NUMERO en la URL';
            document.querySelector('.loading').textContent = 'Ejemplo: ?id=299536';
            return;
        }

        // Fuentes PRO confirmadas trabajando diciembre 2025 (con Avengers Infinity War)
        const sources = [
            // 1. vidsrc.to (el rey actual, HD r√°pido, subs ES/LATAM ‚Äì funciona perfecto ahora)
            `https://vidsrc.to/embed/movie/${id}`,

            // 2. multiembed.mov (cat√°logo enorme como Cuevana, fallback potente)
            `https://multiembed.mov/?video_id=${id}&tmdb=1${season ? `&s=${season}&e=${episode}` : ''}`,

            // 3. vembed.click (nuevo y estable, mucho contenido latino)
            `https://vembed.click/embed/movie/${id}`,

            // 4. autoembed.cc (r√°pido y con todo fresco)
            `https://autoembed.cc/movie/tmdb/${id}${season ? `-${season}-${episode}` : ''}`
        ];

        const iframe = document.getElementById('player');
        let current = 0;

        function loadSource() {
            if (current < sources.length) {
                iframe.src = sources[current];
                current++;
            } else {
                document.querySelector('.loading').textContent = 'Refresca o prueba otra pel√≠cula üòî';
            }
        }

        // T√≠tulo en espa√±ol autom√°tico
        fetch(`https://api.themoviedb.org/3/${season ? 'tv' : 'movie'}/${id}?api_key=936410eebae74f9895643e085cc4a740&language=es-ES`)
            .then(res => res.json())
            .then(data => document.getElementById('title').textContent = (season ? data.name : data.title) || 'JJMovies.lat')
            .catch(() => {});

        iframe.onload = () => document.querySelector('.loading').style.display = 'none';
        iframe.onerror = loadSource;

        loadSource(); // Empieza con vidsrc.to (el que m√°s carga ahora)
    </script>
</body>
</html>
